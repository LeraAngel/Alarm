{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport * as FS from 'expo-file-system';\nimport Alarm from \"./Alarm\";\n\nvar AlarmManager = function () {\n  function AlarmManager() {\n    _classCallCheck(this, AlarmManager);\n\n    this.alarmsList = [];\n  }\n\n  _createClass(AlarmManager, [{\n    key: \"addAlarm\",\n    value: function addAlarm(_ref) {\n      var alarm = _ref.alarm;\n      id = this.alarmsList.length;\n      this.alarmsList.push(alarm);\n      this.save();\n      return id;\n    }\n  }, {\n    key: \"removeAlarm\",\n    value: function removeAlarm(_ref2) {\n      var id = _ref2.id;\n      alarm = this.getAlarm({\n        id: id\n      });\n\n      if (alarm.isActive()) {\n        alarm.deactivate();\n      }\n\n      this.alarmsList.splice(id, 1);\n      this.save();\n    }\n  }, {\n    key: \"getAlarms\",\n    value: function getAlarms() {\n      return this.alarmsList;\n    }\n  }, {\n    key: \"getAlarmsNum\",\n    value: function getAlarmsNum() {\n      return this.alarmsList.length;\n    }\n  }, {\n    key: \"getAlarm\",\n    value: function getAlarm(_ref3) {\n      var id = _ref3.id;\n      return this.alarmsList[id];\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return _regeneratorRuntime.async(function save$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              jsonData = JSON.stringify(this.alarmsList);\n              saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(FS.writeAsStringAsync(saveFilePath, jsonData));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"load\",\n    value: function load(_ref4) {\n      var _this = this;\n\n      var onLoadedCb;\n      return _regeneratorRuntime.async(function load$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              onLoadedCb = _ref4.onLoadedCb;\n              saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n              this.alarmsList = [];\n              FS.readAsStringAsync(saveFilePath).then(function (jsonData) {\n                alarmJsonArray = JSON.parse(jsonData);\n                alarmJsonArray.map(function (alarmJson) {\n                  _this.alarmsList.push(Alarm.fromJson({\n                    jsonObject: alarmJson\n                  }));\n                });\n                onLoadedCb(true);\n              }).catch(function (err) {\n                _this.alarmsList = [];\n                onLoadedCb(false);\n              });\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }]);\n\n  return AlarmManager;\n}();\n\nAlarmManager.saveFileName = \"alarms.json\";\nAlarmManager.instance = AlarmManager.instance || new AlarmManager();\nexport default AlarmManager;","map":{"version":3,"names":["FS","Alarm","AlarmManager","alarmsList","alarm","id","length","push","save","getAlarm","isActive","deactivate","splice","jsonData","JSON","stringify","saveFilePath","documentDirectory","saveFileName","writeAsStringAsync","onLoadedCb","readAsStringAsync","then","alarmJsonArray","parse","map","alarmJson","fromJson","jsonObject","catch","err","instance"],"sources":["C:/Users/lera-/OneDrive/Рабочий стол/Alarm/framework/AlarmManager.js"],"sourcesContent":["import * as FS from 'expo-file-system';\nimport Alarm from './Alarm';\n\n\n\nclass AlarmManager {\n\n    addAlarm({ alarm }) {\n        id = this.alarmsList.length;\n        this.alarmsList.push(alarm);\n        this.save();\n        return id;\n    }\n\n    removeAlarm({ id }) {\n        alarm = this.getAlarm({ id: id });\n        if (alarm.isActive()) {\n            alarm.deactivate();\n        }\n        this.alarmsList.splice(id, 1);\n        this.save();\n    }\n\n    getAlarms() {\n        return this.alarmsList;\n    }\n\n    getAlarmsNum() {\n        return this.alarmsList.length;\n    }\n\n    getAlarm({ id }) {\n        return this.alarmsList[id];\n    }\n\n    async save() {\n        jsonData = JSON.stringify(this.alarmsList);\n        saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n\n        await FS.writeAsStringAsync(saveFilePath, jsonData);\n    }\n\n    async load({ onLoadedCb }) {\n        saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n        this.alarmsList = [];\n\n        FS.readAsStringAsync(saveFilePath)\n            .then((jsonData) => {\n                alarmJsonArray = JSON.parse(jsonData);\n                alarmJsonArray.map((alarmJson) => {\n                    this.alarmsList.push(Alarm.fromJson({ jsonObject: alarmJson }));\n                });\n                onLoadedCb(true);\n            })\n            .catch((err) => {\n                this.alarmsList = [];\n                onLoadedCb(false);\n            });\n    }\n\n    alarmsList = [];\n\n    static saveFileName = \"alarms.json\";\n    static instance = AlarmManager.instance || new AlarmManager();\n}\n\nexport default AlarmManager;\n"],"mappings":";;;AAAA,OAAO,KAAKA,EAAZ,MAAoB,kBAApB;AACA,OAAOC,KAAP;;IAIMC,Y;;;;SAuDFC,U,GAAa,E;;;;;WArDb,wBAAoB;MAAA,IAATC,KAAS,QAATA,KAAS;MAChBC,EAAE,GAAG,KAAKF,UAAL,CAAgBG,MAArB;MACA,KAAKH,UAAL,CAAgBI,IAAhB,CAAqBH,KAArB;MACA,KAAKI,IAAL;MACA,OAAOH,EAAP;IACH;;;WAED,4BAAoB;MAAA,IAANA,EAAM,SAANA,EAAM;MAChBD,KAAK,GAAG,KAAKK,QAAL,CAAc;QAAEJ,EAAE,EAAEA;MAAN,CAAd,CAAR;;MACA,IAAID,KAAK,CAACM,QAAN,EAAJ,EAAsB;QAClBN,KAAK,CAACO,UAAN;MACH;;MACD,KAAKR,UAAL,CAAgBS,MAAhB,CAAuBP,EAAvB,EAA2B,CAA3B;MACA,KAAKG,IAAL;IACH;;;WAED,qBAAY;MACR,OAAO,KAAKL,UAAZ;IACH;;;WAED,wBAAe;MACX,OAAO,KAAKA,UAAL,CAAgBG,MAAvB;IACH;;;WAED,yBAAiB;MAAA,IAAND,EAAM,SAANA,EAAM;MACb,OAAO,KAAKF,UAAL,CAAgBE,EAAhB,CAAP;IACH;;;WAED;MAAA;QAAA;UAAA;YAAA;cACIQ,QAAQ,GAAGC,IAAI,CAACC,SAAL,CAAe,KAAKZ,UAApB,CAAX;cACAa,YAAY,GAAGhB,EAAE,CAACiB,iBAAH,GAAuB,GAAvB,GAA6B,KAAKC,YAAjD;cAFJ;cAAA,iCAIUlB,EAAE,CAACmB,kBAAH,CAAsBH,YAAtB,EAAoCH,QAApC,CAJV;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;;;WAOA;MAAA;;MAAA;MAAA;QAAA;UAAA;YAAA;cAAaO,UAAb,SAAaA,UAAb;cACIJ,YAAY,GAAGhB,EAAE,CAACiB,iBAAH,GAAuB,GAAvB,GAA6B,KAAKC,YAAjD;cACA,KAAKf,UAAL,GAAkB,EAAlB;cAEAH,EAAE,CAACqB,iBAAH,CAAqBL,YAArB,EACKM,IADL,CACU,UAACT,QAAD,EAAc;gBAChBU,cAAc,GAAGT,IAAI,CAACU,KAAL,CAAWX,QAAX,CAAjB;gBACAU,cAAc,CAACE,GAAf,CAAmB,UAACC,SAAD,EAAe;kBAC9B,KAAI,CAACvB,UAAL,CAAgBI,IAAhB,CAAqBN,KAAK,CAAC0B,QAAN,CAAe;oBAAEC,UAAU,EAAEF;kBAAd,CAAf,CAArB;gBACH,CAFD;gBAGAN,UAAU,CAAC,IAAD,CAAV;cACH,CAPL,EAQKS,KARL,CAQW,UAACC,GAAD,EAAS;gBACZ,KAAI,CAAC3B,UAAL,GAAkB,EAAlB;gBACAiB,UAAU,CAAC,KAAD,CAAV;cACH,CAXL;;YAJJ;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;;;;;;AArCElB,Y,CAyDKgB,Y,GAAe,a;AAzDpBhB,Y,CA0DK6B,Q,GAAW7B,YAAY,CAAC6B,QAAb,IAAyB,IAAI7B,YAAJ,E;AAG/C,eAAeA,YAAf"},"metadata":{},"sourceType":"module"}